# Aderyn Analysis Report

This report was generated by [Aderyn](https://github.com/Cyfrin/aderyn), a static analysis tool built by [Cyfrin](https://cyfrin.io), a blockchain security company. This report is not a substitute for manual audit or security review. It should not be relied upon for any purpose other than to assist in the identification of potential security vulnerabilities.
# Table of Contents

- [Summary](#summary)
  - [Files Summary](#files-summary)
  - [Files Details](#files-details)
  - [Issue Summary](#issue-summary)
- [High Issues](#high-issues)
  - [H-1: `abi.encodePacked()` should not be used with dynamic types when passing the result to a hash function such as `keccak256()`](#h-1-abiencodepacked-should-not-be-used-with-dynamic-types-when-passing-the-result-to-a-hash-function-such-as-keccak256)
  - [H-2: Unprotected initializer](#h-2-unprotected-initializer)
- [Low Issues](#low-issues)
  - [L-1: Solidity pragma should be specific, not wide](#l-1-solidity-pragma-should-be-specific-not-wide)
  - [L-2: Missing checks for `address(0)` when assigning values to address state variables](#l-2-missing-checks-for-address0-when-assigning-values-to-address-state-variables)
  - [L-3: `public` functions not used internally could be marked `external`](#l-3-public-functions-not-used-internally-could-be-marked-external)
  - [L-4: Define and use `constant` variables instead of using literals](#l-4-define-and-use-constant-variables-instead-of-using-literals)
  - [L-5: Event is missing `indexed` fields](#l-5-event-is-missing-indexed-fields)
  - [L-6: PUSH0 is not supported by all chains](#l-6-push0-is-not-supported-by-all-chains)
  - [L-7: Modifiers invoked only once can be shoe-horned into the function](#l-7-modifiers-invoked-only-once-can-be-shoe-horned-into-the-function)
  - [L-8: Empty Block](#l-8-empty-block)
  - [L-9: Internal functions called only once can be inlined](#l-9-internal-functions-called-only-once-can-be-inlined)
  - [L-10: Contract still has TODOs](#l-10-contract-still-has-todos)


# Summary

## Files Summary

| Key | Value |
| --- | --- |
| .sol Files | 53 |
| Total nSLOC | 1636 |


## Files Details

| Filepath | nSLOC |
| --- | --- |
| src/PyeRouterV1.1.sol | 162 |
| src/adapters/StakeWise/StakeWiseAdapter.sol | 227 |
| src/adapters/StakeWise/interfaces/IBalancerRateProvider.sol | 4 |
| src/adapters/StakeWise/interfaces/IChainlinkAggregator.sol | 5 |
| src/adapters/StakeWise/interfaces/IChainlinkV3Aggregator.sol | 7 |
| src/adapters/StakeWise/interfaces/ICumulativeMerkleDrop.sol | 12 |
| src/adapters/StakeWise/interfaces/IEthErc20Vault.sol | 22 |
| src/adapters/StakeWise/interfaces/IEthFoxVault.sol | 25 |
| src/adapters/StakeWise/interfaces/IEthGenesisVault.sol | 8 |
| src/adapters/StakeWise/interfaces/IEthPrivErc20Vault.sol | 4 |
| src/adapters/StakeWise/interfaces/IEthPrivVault.sol | 4 |
| src/adapters/StakeWise/interfaces/IEthValidatorsRegistry.sol | 5 |
| src/adapters/StakeWise/interfaces/IEthVault.sol | 20 |
| src/adapters/StakeWise/interfaces/IEthVaultFactory.sol | 8 |
| src/adapters/StakeWise/interfaces/IKeeper.sol | 7 |
| src/adapters/StakeWise/interfaces/IKeeperOracles.sol | 12 |
| src/adapters/StakeWise/interfaces/IKeeperRewards.sol | 43 |
| src/adapters/StakeWise/interfaces/IKeeperValidators.sol | 20 |
| src/adapters/StakeWise/interfaces/IMulticall.sol | 4 |
| src/adapters/StakeWise/interfaces/IOsToken.sol | 12 |
| src/adapters/StakeWise/interfaces/IOsTokenConfig.sol | 18 |
| src/adapters/StakeWise/interfaces/IOsTokenVaultController.sol | 29 |
| src/adapters/StakeWise/interfaces/IOwnMevEscrow.sol | 7 |
| src/adapters/StakeWise/interfaces/IPoolEscrow.sol | 11 |
| src/adapters/StakeWise/interfaces/IRewardEthToken.sol | 7 |
| src/adapters/StakeWise/interfaces/IRewardSplitter.sol | 29 |
| src/adapters/StakeWise/interfaces/IRewardSplitterFactory.sol | 6 |
| src/adapters/StakeWise/interfaces/ISharedMevEscrow.sol | 6 |
| src/adapters/StakeWise/interfaces/IValidatorsRegistry.sol | 5 |
| src/adapters/StakeWise/interfaces/IVaultAdmin.sol | 6 |
| src/adapters/StakeWise/interfaces/IVaultBlocklist.sol | 10 |
| src/adapters/StakeWise/interfaces/IVaultEnterExit.sol | 13 |
| src/adapters/StakeWise/interfaces/IVaultEthStaking.sol | 11 |
| src/adapters/StakeWise/interfaces/IVaultFee.sol | 8 |
| src/adapters/StakeWise/interfaces/IVaultMev.sol | 5 |
| src/adapters/StakeWise/interfaces/IVaultOsToken.sol | 18 |
| src/adapters/StakeWise/interfaces/IVaultState.sol | 17 |
| src/adapters/StakeWise/interfaces/IVaultToken.sol | 7 |
| src/adapters/StakeWise/interfaces/IVaultValidators.sol | 16 |
| src/adapters/StakeWise/interfaces/IVaultVersion.sol | 8 |
| src/adapters/StakeWise/interfaces/IVaultWhitelist.sol | 10 |
| src/adapters/StakeWise/interfaces/IVaultsRegistry.sol | 17 |
| src/interfaces/IBond.sol | 58 |
| src/interfaces/IPTv1.sol | 6 |
| src/interfaces/IPyeRouterV1.sol | 36 |
| src/interfaces/IYTv1.sol | 8 |
| src/libs/ExpiryUtils.sol | 106 |
| src/libs/WadRayMath.sol | 45 |
| src/mock/ExitQueue.sol | 135 |
| src/mock/SwEthVaulMock.sol | 206 |
| src/tokens/ERC20Hook.sol | 128 |
| src/tokens/PTv1.sol | 15 |
| src/tokens/YTv1.sol | 18 |
| **Total** | **1636** |


## Issue Summary

| Category | No. of Issues |
| --- | --- |
| High | 2 |
| Low | 10 |


# High Issues

## H-1: `abi.encodePacked()` should not be used with dynamic types when passing the result to a hash function such as `keccak256()`

Use `abi.encode()` instead which will pad items to 32 bytes, which will [prevent hash collisions](https://docs.soliditylang.org/en/v0.8.13/abi-spec.html#non-standard-packed-mode) (e.g. `abi.encodePacked(0x123,0x456)` => `0x123456` => `abi.encodePacked(0x1,0x23456)`, but `abi.encode(0x123,0x456)` => `0x0...1230...456`). Unless there is a compelling reason, `abi.encode` should be preferred. If there is only one argument to `abi.encodePacked()` it can often be cast to `bytes()` or `bytes32()` [instead](https://ethereum.stackexchange.com/questions/30912/how-to-compare-strings-in-solidity#answer-82739).
If all arguments are strings and or bytes, `bytes.concat()` should be used instead.

- Found in src/adapters/StakeWise/StakeWiseAdapter.sol [Line: 354](src/adapters/StakeWise/StakeWiseAdapter.sol#L354)

	```solidity
	        _name = string(abi.encodePacked(_validatorName, ' ', rfc2822String));
	```

- Found in src/adapters/StakeWise/StakeWiseAdapter.sol [Line: 358](src/adapters/StakeWise/StakeWiseAdapter.sol#L358)

	```solidity
	        _symbol = string(abi.encodePacked('SWETH-', rfc2822String));
	```

- Found in src/libs/ExpiryUtils.sol [Line: 28](src/libs/ExpiryUtils.sol#L28)

	```solidity
	        result = string(abi.encodePacked(_bt, _delimiter, _yt, _delimiter, toRFC2822String(_expiry)));
	```

- Found in src/libs/ExpiryUtils.sol [Line: 36](src/libs/ExpiryUtils.sol#L36)

	```solidity
	        s = string(abi.encodePacked(day, month, year));
	```



## H-2: Unprotected initializer

Consider protecting the initializer functions with modifiers.

- Found in src/adapters/StakeWise/interfaces/IEthErc20Vault.sol [Line: 43](src/adapters/StakeWise/interfaces/IEthErc20Vault.sol#L43)

	```solidity
	    function initialize(bytes calldata params) external payable;
	```

- Found in src/adapters/StakeWise/interfaces/IEthFoxVault.sol [Line: 60](src/adapters/StakeWise/interfaces/IEthFoxVault.sol#L60)

	```solidity
	    function initialize(bytes calldata params) external payable;
	```

- Found in src/adapters/StakeWise/interfaces/IEthVault.sol [Line: 39](src/adapters/StakeWise/interfaces/IEthVault.sol#L39)

	```solidity
	    function initialize(bytes calldata params) external payable;
	```

- Found in src/adapters/StakeWise/interfaces/IKeeper.sol [Line: 19](src/adapters/StakeWise/interfaces/IKeeper.sol#L19)

	```solidity
	    function initialize(address _owner) external;
	```

- Found in src/adapters/StakeWise/interfaces/IRewardSplitter.sol [Line: 74](src/adapters/StakeWise/interfaces/IRewardSplitter.sol#L74)

	```solidity
	    function initialize(address owner, address _vault) external;
	```

- Found in src/adapters/StakeWise/interfaces/IVaultsRegistry.sol [Line: 97](src/adapters/StakeWise/interfaces/IVaultsRegistry.sol#L97)

	```solidity
	    function initialize(address _owner) external;
	```

- Found in src/interfaces/IBond.sol [Line: 44](src/interfaces/IBond.sol#L44)

	```solidity
	    function initialize(address _validator, uint96 maturityDate_) external payable;
	```



# Low Issues

## L-1: Solidity pragma should be specific, not wide

Consider using a specific version of Solidity in your contracts instead of a wide version. For example, instead of `pragma solidity ^0.8.0;`, use `pragma solidity 0.8.0;`

- Found in src/PyeRouterV1.1.sol [Line: 2](src/PyeRouterV1.1.sol#L2)

	```solidity
	pragma solidity ^0.8.19;
	```

- Found in src/adapters/StakeWise/StakeWiseAdapter.sol [Line: 2](src/adapters/StakeWise/StakeWiseAdapter.sol#L2)

	```solidity
	pragma solidity ^0.8.20;
	```

- Found in src/interfaces/IBond.sol [Line: 2](src/interfaces/IBond.sol#L2)

	```solidity
	pragma solidity ^0.8.20;
	```

- Found in src/interfaces/IPTv1.sol [Line: 2](src/interfaces/IPTv1.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/interfaces/IPyeRouterV1.sol [Line: 2](src/interfaces/IPyeRouterV1.sol#L2)

	```solidity
	pragma solidity ^0.8.19;
	```

- Found in src/interfaces/IYTv1.sol [Line: 2](src/interfaces/IYTv1.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/libs/ExpiryUtils.sol [Line: 2](src/libs/ExpiryUtils.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/libs/WadRayMath.sol [Line: 2](src/libs/WadRayMath.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/mock/SwEthVaulMock.sol [Line: 2](src/mock/SwEthVaulMock.sol#L2)

	```solidity
	pragma solidity ^0.8.20;
	```

- Found in src/tokens/ERC20Hook.sol [Line: 4](src/tokens/ERC20Hook.sol#L4)

	```solidity
	pragma solidity ^0.8.20;
	```

- Found in src/tokens/PTv1.sol [Line: 2](src/tokens/PTv1.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/tokens/YTv1.sol [Line: 2](src/tokens/YTv1.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```



## L-2: Missing checks for `address(0)` when assigning values to address state variables

Check for `address(0)` when assigning values to address state variables.

- Found in src/PyeRouterV1.1.sol [Line: 41](src/PyeRouterV1.1.sol#L41)

	```solidity
	        feeRecipient = _checkAddressZero(_feeRecipient);
	```

- Found in src/PyeRouterV1.1.sol [Line: 42](src/PyeRouterV1.1.sol#L42)

	```solidity
	        defaultBeacon = _checkAddressZero(_beacon);
	```

- Found in src/PyeRouterV1.1.sol [Line: 172](src/PyeRouterV1.1.sol#L172)

	```solidity
	        defaultBeacon = _newBeacon;
	```

- Found in src/adapters/StakeWise/StakeWiseAdapter.sol [Line: 108](src/adapters/StakeWise/StakeWiseAdapter.sol#L108)

	```solidity
	        _ethVault = IEthVault(_validator);
	```

- Found in src/mock/SwEthVaulMock.sol [Line: 234](src/mock/SwEthVaulMock.sol#L234)

	```solidity
	        _balances[owner] += shares;
	```

- Found in src/mock/SwEthVaulMock.sol [Line: 302](src/mock/SwEthVaulMock.sol#L302)

	```solidity
	        _ethVaultMock = ethVaultMock_;
	```

- Found in src/tokens/ERC20Hook.sol [Line: 203](src/tokens/ERC20Hook.sol#L203)

	```solidity
	                _balances[from] = fromBalance - value;
	```

- Found in src/tokens/ERC20Hook.sol [Line: 215](src/tokens/ERC20Hook.sol#L215)

	```solidity
	                _balances[to] += value;
	```

- Found in src/tokens/ERC20Hook.sol [Line: 234](src/tokens/ERC20Hook.sol#L234)

	```solidity
	            _isPtLocked[account] = isTransferLock;
	```

- Found in src/tokens/ERC20Hook.sol [Line: 301](src/tokens/ERC20Hook.sol#L301)

	```solidity
	        _allowances[owner][spender] = value;
	```



## L-3: `public` functions not used internally could be marked `external`

Instead of marking a function as `public`, consider marking it as `external` if it is not used internally.

- Found in src/adapters/StakeWise/StakeWiseAdapter.sol [Line: 283](src/adapters/StakeWise/StakeWiseAdapter.sol#L283)

	```solidity
	    function exitRequest() public view override returns (ExitRequest memory) {
	```

- Found in src/adapters/StakeWise/StakeWiseAdapter.sol [Line: 291](src/adapters/StakeWise/StakeWiseAdapter.sol#L291)

	```solidity
	    function convertToAssets(uint256 shares) public view override returns (uint256 assets) {
	```

- Found in src/adapters/StakeWise/StakeWiseAdapter.sol [Line: 295](src/adapters/StakeWise/StakeWiseAdapter.sol#L295)

	```solidity
	    function totalAssets() public view override returns (uint256 assets) {
	```

- Found in src/adapters/StakeWise/StakeWiseAdapter.sol [Line: 299](src/adapters/StakeWise/StakeWiseAdapter.sol#L299)

	```solidity
	    function totalShares() public view override returns (uint256 assets) {
	```

- Found in src/mock/SwEthVaulMock.sol [Line: 135](src/mock/SwEthVaulMock.sol#L135)

	```solidity
	    function enterExitQueue(uint256 shares, address receiver) public _updateRewards returns (uint256 positionTicket) {
	```

- Found in src/tokens/ERC20Hook.sol [Line: 59](src/tokens/ERC20Hook.sol#L59)

	```solidity
	    function name() public view virtual returns (string memory) {
	```

- Found in src/tokens/ERC20Hook.sol [Line: 67](src/tokens/ERC20Hook.sol#L67)

	```solidity
	    function symbol() public view virtual returns (string memory) {
	```

- Found in src/tokens/ERC20Hook.sol [Line: 84](src/tokens/ERC20Hook.sol#L84)

	```solidity
	    function decimals() public view virtual returns (uint8) {
	```

- Found in src/tokens/ERC20Hook.sol [Line: 91](src/tokens/ERC20Hook.sol#L91)

	```solidity
	    function totalSupply() public view virtual returns (uint256) {
	```

- Found in src/tokens/ERC20Hook.sol [Line: 98](src/tokens/ERC20Hook.sol#L98)

	```solidity
	    function balanceOf(address account) public view virtual returns (uint256) {
	```

- Found in src/tokens/ERC20Hook.sol [Line: 110](src/tokens/ERC20Hook.sol#L110)

	```solidity
	    function transfer(address to, uint256 value) public virtual returns (bool) {
	```

- Found in src/tokens/ERC20Hook.sol [Line: 135](src/tokens/ERC20Hook.sol#L135)

	```solidity
	    function approve(address spender, uint256 value) public virtual returns (bool) {
	```

- Found in src/tokens/ERC20Hook.sol [Line: 157](src/tokens/ERC20Hook.sol#L157)

	```solidity
	    function transferFrom(address from, address to, uint256 value) public virtual returns (bool) {
	```

- Found in src/tokens/PTv1.sol [Line: 19](src/tokens/PTv1.sol#L19)

	```solidity
	    function burn(address account, uint256 amount) public {
	```



## L-4: Define and use `constant` variables instead of using literals

If the same constant literal value is used multiple times, create a constant state variable and reference it throughout the contract.

- Found in src/adapters/StakeWise/StakeWiseAdapter.sol [Line: 331](src/adapters/StakeWise/StakeWiseAdapter.sol#L331)

	```solidity
	        require(bps <= 10_000, 'Wrong percent');
	```

- Found in src/adapters/StakeWise/StakeWiseAdapter.sol [Line: 332](src/adapters/StakeWise/StakeWiseAdapter.sol#L332)

	```solidity
	        _percentAmt = amount.mulDiv(bps, 10_000);
	```

- Found in src/libs/ExpiryUtils.sol [Line: 40](src/libs/ExpiryUtils.sol#L40)

	```solidity
	        if (_month == 1 || _month == 3 || _month == 5 || _month == 7 || _month == 8 || _month == 10 || _month == 12) {
	```

- Found in src/libs/ExpiryUtils.sol [Line: 42](src/libs/ExpiryUtils.sol#L42)

	```solidity
	        } else if (_month == 4 || _month == 6 || _month == 9 || _month == 11) {
	```

- Found in src/libs/ExpiryUtils.sol [Line: 75](src/libs/ExpiryUtils.sol#L75)

	```solidity
	        return ((_year % 4 == 0) && (_year % 100 != 0)) || (_year % 400 == 0);
	```

- Found in src/libs/ExpiryUtils.sol [Line: 80](src/libs/ExpiryUtils.sol#L80)

	```solidity
	        return _year / 4 - _year / 100 + _year / 400;
	```

- Found in src/libs/ExpiryUtils.sol [Line: 84](src/libs/ExpiryUtils.sol#L84)

	```solidity
	        string[12] memory months = ['JAN', 'FEB', 'MAR', 'APR', 'MAY', 'JUN', 'JUL', 'AUG', 'SEP', 'OCT', 'NOV', 'DEC'];
	```

- Found in src/libs/ExpiryUtils.sol [Line: 102](src/libs/ExpiryUtils.sol#L102)

	```solidity
	        for (i = 1; i <= 12; i++) {
	```

- Found in src/libs/ExpiryUtils.sol [Line: 129](src/libs/ExpiryUtils.sol#L129)

	```solidity
	            j /= 10;
	```

- Found in src/libs/ExpiryUtils.sol [Line: 134](src/libs/ExpiryUtils.sol#L134)

	```solidity
	            bstr[k] = bytes1(uint8(48 + (_i % 10)));
	```

- Found in src/libs/ExpiryUtils.sol [Line: 136](src/libs/ExpiryUtils.sol#L136)

	```solidity
	            _i /= 10;
	```

- Found in src/mock/SwEthVaulMock.sol [Line: 289](src/mock/SwEthVaulMock.sol#L289)

	```solidity
	        require(bps <= 10_000, 'Wrong percent');
	```

- Found in src/mock/SwEthVaulMock.sol [Line: 290](src/mock/SwEthVaulMock.sol#L290)

	```solidity
	        _percentAmt = amount.mulDiv(bps, 10_000);
	```



## L-5: Event is missing `indexed` fields

Index event fields make the field more quickly accessible to off-chain tools that parse events. However, note that each index field costs extra gas during emission, so it's not necessarily best to index the maximum allowed per event (three fields). Each event should use three indexed fields if there are three or more fields, and gas usage is not particularly of concern for the events in question. If there are fewer than three fields, all of the fields should be indexed.

- Found in src/adapters/StakeWise/interfaces/ICumulativeMerkleDrop.sol [Line: 22](src/adapters/StakeWise/interfaces/ICumulativeMerkleDrop.sol#L22)

	```solidity
	    event MerkleRootUpdated(bytes32 indexed merkleRoot, string proofsIpfsHash);
	```

- Found in src/adapters/StakeWise/interfaces/ICumulativeMerkleDrop.sol [Line: 29](src/adapters/StakeWise/interfaces/ICumulativeMerkleDrop.sol#L29)

	```solidity
	    event Claimed(address indexed account, uint256 cumulativeAmount);
	```

- Found in src/adapters/StakeWise/interfaces/IEthFoxVault.sol [Line: 28](src/adapters/StakeWise/interfaces/IEthFoxVault.sol#L28)

	```solidity
	    event UserEjected(address user, uint256 shares);
	```

- Found in src/adapters/StakeWise/interfaces/IEthFoxVault.sol [Line: 54](src/adapters/StakeWise/interfaces/IEthFoxVault.sol#L54)

	```solidity
	    event EthFoxVaultCreated(address admin, address ownMevEscrow, uint256 capacity, uint16 feePercent, string metadataIpfsHash);
	```

- Found in src/adapters/StakeWise/interfaces/IEthGenesisVault.sol [Line: 19](src/adapters/StakeWise/interfaces/IEthGenesisVault.sol#L19)

	```solidity
	    event Migrated(address receiver, uint256 assets, uint256 shares);
	```

- Found in src/adapters/StakeWise/interfaces/IEthGenesisVault.sol [Line: 28](src/adapters/StakeWise/interfaces/IEthGenesisVault.sol#L28)

	```solidity
	    event GenesisVaultCreated(address admin, uint256 capacity, uint16 feePercent, string metadataIpfsHash);
	```

- Found in src/adapters/StakeWise/interfaces/IEthVaultFactory.sol [Line: 18](src/adapters/StakeWise/interfaces/IEthVaultFactory.sol#L18)

	```solidity
	    event VaultCreated(address indexed admin, address indexed vault, address ownMevEscrow, bytes params);
	```

- Found in src/adapters/StakeWise/interfaces/IKeeperOracles.sol [Line: 29](src/adapters/StakeWise/interfaces/IKeeperOracles.sol#L29)

	```solidity
	    event ConfigUpdated(string configIpfsHash);
	```

- Found in src/adapters/StakeWise/interfaces/IKeeperRewards.sol [Line: 22](src/adapters/StakeWise/interfaces/IKeeperRewards.sol#L22)

	```solidity
	    event RewardsUpdated(address indexed caller, bytes32 indexed rewardsRoot, uint256 avgRewardPerSecond, uint64 updateTimestamp, uint64 nonce, string rewardsIpfsHash);
	```

- Found in src/adapters/StakeWise/interfaces/IKeeperRewards.sol [Line: 31](src/adapters/StakeWise/interfaces/IKeeperRewards.sol#L31)

	```solidity
	    event Harvested(address indexed vault, bytes32 indexed rewardsRoot, int256 totalAssetsDelta, uint256 unlockedMevDelta);
	```

- Found in src/adapters/StakeWise/interfaces/IKeeperRewards.sol [Line: 37](src/adapters/StakeWise/interfaces/IKeeperRewards.sol#L37)

	```solidity
	    event RewardsMinOraclesUpdated(uint256 oracles);
	```

- Found in src/adapters/StakeWise/interfaces/IKeeperValidators.sol [Line: 19](src/adapters/StakeWise/interfaces/IKeeperValidators.sol#L19)

	```solidity
	    event ValidatorsApproval(address indexed vault, string exitSignaturesIpfsHash);
	```

- Found in src/adapters/StakeWise/interfaces/IKeeperValidators.sol [Line: 28](src/adapters/StakeWise/interfaces/IKeeperValidators.sol#L28)

	```solidity
	    event ExitSignaturesUpdated(address indexed caller, address indexed vault, uint256 nonce, string exitSignaturesIpfsHash);
	```

- Found in src/adapters/StakeWise/interfaces/IKeeperValidators.sol [Line: 34](src/adapters/StakeWise/interfaces/IKeeperValidators.sol#L34)

	```solidity
	    event ValidatorsMinOraclesUpdated(uint256 oracles);
	```

- Found in src/adapters/StakeWise/interfaces/IOsToken.sol [Line: 21](src/adapters/StakeWise/interfaces/IOsToken.sol#L21)

	```solidity
	    event ControllerUpdated(address indexed controller, bool registered);
	```

- Found in src/adapters/StakeWise/interfaces/IOsTokenConfig.sol [Line: 19](src/adapters/StakeWise/interfaces/IOsTokenConfig.sol#L19)

	```solidity
	    event OsTokenConfigUpdated(uint16 redeemFromLtvPercent, uint16 redeemToLtvPercent, uint16 liqThresholdPercent, uint16 liqBonusPercent, uint16 ltvPercent);
	```

- Found in src/adapters/StakeWise/interfaces/IOsTokenVaultController.sol [Line: 18](src/adapters/StakeWise/interfaces/IOsTokenVaultController.sol#L18)

	```solidity
	    event Mint(address indexed vault, address indexed receiver, uint256 assets, uint256 shares);
	```

- Found in src/adapters/StakeWise/interfaces/IOsTokenVaultController.sol [Line: 27](src/adapters/StakeWise/interfaces/IOsTokenVaultController.sol#L27)

	```solidity
	    event Burn(address indexed vault, address indexed owner, uint256 assets, uint256 shares);
	```

- Found in src/adapters/StakeWise/interfaces/IOsTokenVaultController.sol [Line: 35](src/adapters/StakeWise/interfaces/IOsTokenVaultController.sol#L35)

	```solidity
	    event StateUpdated(uint256 profitAccrued, uint256 treasuryShares, uint256 treasuryAssets);
	```

- Found in src/adapters/StakeWise/interfaces/IOsTokenVaultController.sol [Line: 41](src/adapters/StakeWise/interfaces/IOsTokenVaultController.sol#L41)

	```solidity
	    event CapacityUpdated(uint256 capacity);
	```

- Found in src/adapters/StakeWise/interfaces/IOsTokenVaultController.sol [Line: 53](src/adapters/StakeWise/interfaces/IOsTokenVaultController.sol#L53)

	```solidity
	    event FeePercentUpdated(uint16 feePercent);
	```

- Found in src/adapters/StakeWise/interfaces/IOsTokenVaultController.sol [Line: 59](src/adapters/StakeWise/interfaces/IOsTokenVaultController.sol#L59)

	```solidity
	    event AvgRewardPerSecondUpdated(uint256 avgRewardPerSecond);
	```

- Found in src/adapters/StakeWise/interfaces/IOsTokenVaultController.sol [Line: 65](src/adapters/StakeWise/interfaces/IOsTokenVaultController.sol#L65)

	```solidity
	    event KeeperUpdated(address keeper);
	```

- Found in src/adapters/StakeWise/interfaces/IOwnMevEscrow.sol [Line: 15](src/adapters/StakeWise/interfaces/IOwnMevEscrow.sol#L15)

	```solidity
	    event MevReceived(uint256 assets);
	```

- Found in src/adapters/StakeWise/interfaces/IOwnMevEscrow.sol [Line: 21](src/adapters/StakeWise/interfaces/IOwnMevEscrow.sol#L21)

	```solidity
	    event Harvested(uint256 assets);
	```

- Found in src/adapters/StakeWise/interfaces/IPoolEscrow.sol [Line: 18](src/adapters/StakeWise/interfaces/IPoolEscrow.sol#L18)

	```solidity
	    event Withdrawn(address indexed sender, address indexed payee, uint256 amount);
	```

- Found in src/adapters/StakeWise/interfaces/IRewardSplitter.sol [Line: 34](src/adapters/StakeWise/interfaces/IRewardSplitter.sol#L34)

	```solidity
	    event SharesIncreased(address indexed account, uint256 amount);
	```

- Found in src/adapters/StakeWise/interfaces/IRewardSplitter.sol [Line: 41](src/adapters/StakeWise/interfaces/IRewardSplitter.sol#L41)

	```solidity
	    event SharesDecreased(address indexed account, uint256 amount);
	```

- Found in src/adapters/StakeWise/interfaces/IRewardSplitter.sol [Line: 48](src/adapters/StakeWise/interfaces/IRewardSplitter.sol#L48)

	```solidity
	    event RewardsSynced(uint256 totalRewards, uint256 rewardPerShare);
	```

- Found in src/adapters/StakeWise/interfaces/IRewardSplitter.sol [Line: 55](src/adapters/StakeWise/interfaces/IRewardSplitter.sol#L55)

	```solidity
	    event RewardsWithdrawn(address indexed account, uint256 amount);
	```

- Found in src/adapters/StakeWise/interfaces/IRewardSplitterFactory.sol [Line: 17](src/adapters/StakeWise/interfaces/IRewardSplitterFactory.sol#L17)

	```solidity
	    event RewardSplitterCreated(address owner, address vault, address rewardSplitter);
	```

- Found in src/adapters/StakeWise/interfaces/ISharedMevEscrow.sol [Line: 15](src/adapters/StakeWise/interfaces/ISharedMevEscrow.sol#L15)

	```solidity
	    event MevReceived(uint256 assets);
	```

- Found in src/adapters/StakeWise/interfaces/ISharedMevEscrow.sol [Line: 22](src/adapters/StakeWise/interfaces/ISharedMevEscrow.sol#L22)

	```solidity
	    event Harvested(address indexed caller, uint256 assets);
	```

- Found in src/adapters/StakeWise/interfaces/IValidatorsRegistry.sol [Line: 12](src/adapters/StakeWise/interfaces/IValidatorsRegistry.sol#L12)

	```solidity
	    event DepositEvent(bytes pubkey, bytes withdrawal_credentials, bytes amount, bytes signature, bytes index);
	```

- Found in src/adapters/StakeWise/interfaces/IVaultAdmin.sol [Line: 16](src/adapters/StakeWise/interfaces/IVaultAdmin.sol#L16)

	```solidity
	    event MetadataUpdated(address indexed caller, string metadataIpfsHash);
	```

- Found in src/adapters/StakeWise/interfaces/IVaultBlocklist.sol [Line: 19](src/adapters/StakeWise/interfaces/IVaultBlocklist.sol#L19)

	```solidity
	    event BlocklistUpdated(address indexed caller, address indexed account, bool isBlocked);
	```

- Found in src/adapters/StakeWise/interfaces/IVaultEnterExit.sol [Line: 21](src/adapters/StakeWise/interfaces/IVaultEnterExit.sol#L21)

	```solidity
	    event Deposited(address indexed caller, address indexed receiver, uint256 assets, uint256 shares, address referrer);
	```

- Found in src/adapters/StakeWise/interfaces/IVaultEnterExit.sol [Line: 30](src/adapters/StakeWise/interfaces/IVaultEnterExit.sol#L30)

	```solidity
	    event Redeemed(address indexed owner, address indexed receiver, uint256 assets, uint256 shares);
	```

- Found in src/adapters/StakeWise/interfaces/IVaultEnterExit.sol [Line: 39](src/adapters/StakeWise/interfaces/IVaultEnterExit.sol#L39)

	```solidity
	    event ExitQueueEntered(address indexed owner, address indexed receiver, uint256 positionTicket, uint256 shares);
	```

- Found in src/adapters/StakeWise/interfaces/IVaultEnterExit.sol [Line: 48](src/adapters/StakeWise/interfaces/IVaultEnterExit.sol#L48)

	```solidity
	    event ExitedAssetsClaimed(address indexed receiver, uint256 prevPositionTicket, uint256 newPositionTicket, uint256 withdrawnAssets);
	```

- Found in src/adapters/StakeWise/interfaces/IVaultOsToken.sol [Line: 22](src/adapters/StakeWise/interfaces/IVaultOsToken.sol#L22)

	```solidity
	    event OsTokenMinted(address indexed caller, address receiver, uint256 assets, uint256 shares, address referrer);
	```

- Found in src/adapters/StakeWise/interfaces/IVaultOsToken.sol [Line: 30](src/adapters/StakeWise/interfaces/IVaultOsToken.sol#L30)

	```solidity
	    event OsTokenBurned(address indexed caller, uint256 assets, uint256 shares);
	```

- Found in src/adapters/StakeWise/interfaces/IVaultOsToken.sol [Line: 41](src/adapters/StakeWise/interfaces/IVaultOsToken.sol#L41)

	```solidity
	    event OsTokenLiquidated(address indexed caller, address indexed user, address receiver, uint256 osTokenShares, uint256 shares, uint256 receivedAssets);
	```

- Found in src/adapters/StakeWise/interfaces/IVaultOsToken.sol [Line: 52](src/adapters/StakeWise/interfaces/IVaultOsToken.sol#L52)

	```solidity
	    event OsTokenRedeemed(address indexed caller, address indexed user, address receiver, uint256 osTokenShares, uint256 shares, uint256 assets);
	```

- Found in src/adapters/StakeWise/interfaces/IVaultState.sol [Line: 19](src/adapters/StakeWise/interfaces/IVaultState.sol#L19)

	```solidity
	    event CheckpointCreated(uint256 shares, uint256 assets);
	```

- Found in src/adapters/StakeWise/interfaces/IVaultState.sol [Line: 27](src/adapters/StakeWise/interfaces/IVaultState.sol#L27)

	```solidity
	    event FeeSharesMinted(address receiver, uint256 shares, uint256 assets);
	```

- Found in src/adapters/StakeWise/interfaces/IVaultValidators.sol [Line: 19](src/adapters/StakeWise/interfaces/IVaultValidators.sol#L19)

	```solidity
	    event ValidatorRegistered(bytes publicKey);
	```

- Found in src/adapters/StakeWise/interfaces/IVaultWhitelist.sol [Line: 19](src/adapters/StakeWise/interfaces/IVaultWhitelist.sol#L19)

	```solidity
	    event WhitelistUpdated(address indexed caller, address indexed account, bool approved);
	```

- Found in src/interfaces/IBond.sol [Line: 34](src/interfaces/IBond.sol#L34)

	```solidity
	    event InitializeBond(address pt, address yt, address providerVault, uint96 maturityDate);
	```

- Found in src/interfaces/IBond.sol [Line: 35](src/interfaces/IBond.sol#L35)

	```solidity
	    event EnterExitQueueEvent(address indexed receiver, uint256 shares, uint256 indexed exitTicket, uint256 exitTimestamp);
	```

- Found in src/interfaces/IBond.sol [Line: 36](src/interfaces/IBond.sol#L36)

	```solidity
	    event UnstakeEvent(address sender, uint256 newPositionTicket, uint256 claimedShares, uint256 claimedAssets, uint256 claimedYield);
	```

- Found in src/interfaces/IBond.sol [Line: 37](src/interfaces/IBond.sol#L37)

	```solidity
	    event PositionRedeemEvent(address sender, address token, uint256 redeemAssets);
	```

- Found in src/interfaces/IBond.sol [Line: 39](src/interfaces/IBond.sol#L39)

	```solidity
	    event NewPositionEvent(address sender, uint256 amount, uint256 maturity, uint256 openShares, uint256 openSharePrice);
	```

- Found in src/interfaces/IPyeRouterV1.sol [Line: 30](src/interfaces/IPyeRouterV1.sol#L30)

	```solidity
	    event BondCreated(BondStorage bondStorage);
	```

- Found in src/interfaces/IPyeRouterV1.sol [Line: 32](src/interfaces/IPyeRouterV1.sol#L32)

	```solidity
	    event MintFeeEdited(uint256 previousFee, uint256 newFee);
	```

- Found in src/interfaces/IPyeRouterV1.sol [Line: 36](src/interfaces/IPyeRouterV1.sol#L36)

	```solidity
	    event DepositEvent(address indexed sender, uint256 amount, bool isPtLocked, address validatorVault, uint96 maturity, address bondAddress);
	```

- Found in src/interfaces/IPyeRouterV1.sol [Line: 37](src/interfaces/IPyeRouterV1.sol#L37)

	```solidity
	    event UnstakeRequestedEvent(address indexed sender, address indexed validatorVault, uint96 maturity);
	```

- Found in src/interfaces/IPyeRouterV1.sol [Line: 38](src/interfaces/IPyeRouterV1.sol#L38)

	```solidity
	    event UnstakeEvent(address sender, address validatorVault, uint96 maturity);
	```

- Found in src/interfaces/IPyeRouterV1.sol [Line: 39](src/interfaces/IPyeRouterV1.sol#L39)

	```solidity
	    event PositionRedeemEvent(address indexed sender, address token, uint256 redeemAssets);
	```

- Found in src/mock/ExitQueue.sol [Line: 65](src/mock/ExitQueue.sol#L65)

	```solidity
	    event CalculateExitedAssets(string a, uint256 b, uint256 c);
	```

- Found in src/mock/SwEthVaulMock.sol [Line: 37](src/mock/SwEthVaulMock.sol#L37)

	```solidity
	    event Log(string message, uint256 value);
	```

- Found in src/mock/SwEthVaulMock.sol [Line: 38](src/mock/SwEthVaulMock.sol#L38)

	```solidity
	    event CheckpointCreated(uint256 shares, uint256 assets);
	```

- Found in src/mock/SwEthVaulMock.sol [Line: 39](src/mock/SwEthVaulMock.sol#L39)

	```solidity
	    event SharesMinted(address indexed owner, uint256 shares);
	```

- Found in src/mock/SwEthVaulMock.sol [Line: 40](src/mock/SwEthVaulMock.sol#L40)

	```solidity
	    event ExitQueueUpdated(uint256 burnedShares, uint256 exitedAssets);
	```

- Found in src/mock/SwEthVaulMock.sol [Line: 41](src/mock/SwEthVaulMock.sol#L41)

	```solidity
	    event UpdatedRewardsEvent(uint256 shares, uint256 elapsed, uint192 periodRewards);
	```

- Found in src/mock/SwEthVaulMock.sol [Line: 42](src/mock/SwEthVaulMock.sol#L42)

	```solidity
	    event Deposited(address indexed from, address indexed to, uint256 assets, uint256 shares, address referrer);
	```

- Found in src/mock/SwEthVaulMock.sol [Line: 43](src/mock/SwEthVaulMock.sol#L43)

	```solidity
	    event ExitQueueEntered(address indexed user, address indexed receiver, uint256 positionTicket, uint256 shares);
	```

- Found in src/mock/SwEthVaulMock.sol [Line: 44](src/mock/SwEthVaulMock.sol#L44)

	```solidity
	    event ExitedAssetsClaimed(address indexed receiver, uint256 positionTicket, uint256 newPositionTicket, uint256 claimedAssets);
	```

- Found in src/mock/SwEthVaulMock.sol [Line: 45](src/mock/SwEthVaulMock.sol#L45)

	```solidity
	    event CalculateExitedAssetsEvent(uint256 leftShares, uint256 claimedShares, uint256 claimedAssets);
	```

- Found in src/mock/SwEthVaulMock.sol [Line: 47](src/mock/SwEthVaulMock.sol#L47)

	```solidity
	    event LogRewards(string a, uint256 b);
	```

- Found in src/mock/SwEthVaulMock.sol [Line: 167](src/mock/SwEthVaulMock.sol#L167)

	```solidity
	    event ExitRequest(string message, uint256 exitRequest);
	```

- Found in src/tokens/ERC20Hook.sol [Line: 222](src/tokens/ERC20Hook.sol#L222)

	```solidity
	    event InitTrasnferLockEvent(address account, bool isTransferLock);
	```



## L-6: PUSH0 is not supported by all chains

Solc compiler version 0.8.20 switches the default target EVM version to Shanghai, which means that the generated bytecode will include PUSH0 opcodes. Be sure to select the appropriate EVM version in case you intend to deploy on a chain other than mainnet like L2 chains that may not support PUSH0, otherwise deployment of your contracts will fail.

- Found in src/PyeRouterV1.1.sol [Line: 2](src/PyeRouterV1.1.sol#L2)

	```solidity
	pragma solidity ^0.8.19;
	```

- Found in src/adapters/StakeWise/StakeWiseAdapter.sol [Line: 2](src/adapters/StakeWise/StakeWiseAdapter.sol#L2)

	```solidity
	pragma solidity ^0.8.20;
	```

- Found in src/interfaces/IBond.sol [Line: 2](src/interfaces/IBond.sol#L2)

	```solidity
	pragma solidity ^0.8.20;
	```

- Found in src/interfaces/IPTv1.sol [Line: 2](src/interfaces/IPTv1.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/interfaces/IPyeRouterV1.sol [Line: 2](src/interfaces/IPyeRouterV1.sol#L2)

	```solidity
	pragma solidity ^0.8.19;
	```

- Found in src/interfaces/IYTv1.sol [Line: 2](src/interfaces/IYTv1.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/libs/ExpiryUtils.sol [Line: 2](src/libs/ExpiryUtils.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/libs/WadRayMath.sol [Line: 2](src/libs/WadRayMath.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in src/mock/SwEthVaulMock.sol [Line: 2](src/mock/SwEthVaulMock.sol#L2)

	```solidity
	pragma solidity ^0.8.20;
	```

- Found in src/tokens/ERC20Hook.sol [Line: 4](src/tokens/ERC20Hook.sol#L4)

	```solidity
	pragma solidity ^0.8.20;
	```

- Found in src/tokens/PTv1.sol [Line: 2](src/tokens/PTv1.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```

- Found in src/tokens/YTv1.sol [Line: 2](src/tokens/YTv1.sol#L2)

	```solidity
	pragma solidity ^0.8.13;
	```



## L-7: Modifiers invoked only once can be shoe-horned into the function



- Found in src/adapters/StakeWise/StakeWiseAdapter.sol [Line: 84](src/adapters/StakeWise/StakeWiseAdapter.sol#L84)

	```solidity
	    modifier onlyRouter() {
	```



## L-8: Empty Block

Consider removing empty blocks.

- Found in src/mock/SwEthVaulMock.sol [Line: 111](src/mock/SwEthVaulMock.sol#L111)

	```solidity
	    function updateStateAndDeposit(address receiver, address referrer, HarvestParams calldata harvestParams) external payable returns (uint256 shares) {}
	```

- Found in src/mock/SwEthVaulMock.sol [Line: 217](src/mock/SwEthVaulMock.sol#L217)

	```solidity
	    function updateState(HarvestParams calldata harvestParams) external {}
	```

- Found in src/mock/SwEthVaulMock.sol [Line: 219](src/mock/SwEthVaulMock.sol#L219)

	```solidity
	    function withdrawableAssets() external returns (uint256) {}
	```

- Found in src/tokens/ERC20Hook.sol [Line: 123](src/tokens/ERC20Hook.sol#L123)

	```solidity
	    function _beforeTokenTransfer(address from, address to, uint256 value) internal virtual {}
	```



## L-9: Internal functions called only once can be inlined

Instead of separating the logic into a separate function, consider inlining the logic into the calling function. This can reduce the number of function calls and improve readability.

- Found in src/mock/ExitQueue.sol [Line: 34](src/mock/ExitQueue.sol#L34)

	```solidity
	    function getLatestTotalTickets(History storage self) internal view returns (uint256) {
	```



## L-10: Contract still has TODOs

Contract contains comments with TODOS

- Found in src/adapters/StakeWise/StakeWiseAdapter.sol [Line: 22](src/adapters/StakeWise/StakeWiseAdapter.sol#L22)

	```solidity
	contract StakeWiseAdapter is IBond, Initializable {
	```



